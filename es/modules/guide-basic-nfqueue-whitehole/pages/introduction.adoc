= Introducci칩n
include::{partialsdir}/attributes-es.adoc[]
:guidename: basic-nfqueue-whitehole

TODO

.Secuencia de resoluci칩n DNS con xlist y resolvcache
[plantuml,{guidename}-sequence1,png,pdfwidth=70%]
----
actor dnsclient
participant "DNS Server\n(ludns)" as dnsserver
participant "XList Server\n(xlistd)" as xlistd
participant "Cache Server\n(resolvcache)" as resolvcache
participant "External\nDNS Server" as dnsext #99FF99

dnsclient -> dnsserver: query www.google.com
dnsserver -> xlistd: check(www.google.com)
xlistd --> dnsserver: {result: true, reason: "not in whitelist"}
dnsserver --> dnsclient: nxdomain

dnsclient -> dnsserver: query www.ubuntu.com
dnsserver -> xlistd: check(www.ubuntu.com)
xlistd --> dnsserver: {result: false}
dnsserver -> dnsext: query www.ubuntu.com
dnsext --> dnsserver: 1.2.3.4
dnsserver -> resolvcache: collect(192.168.1.1,www.ubuntu.com,1.2.3.4)
resolvcache --> dnsserver: ok
dnsserver --> dnsclient: 1.2.3.4
----

.*Secuencia de un firewall Netfilter con resolvcache*
[plantuml,{guidename}-sequence2,png,pdfwidth=70%]
----
actor "Netfilter Queue\n(iptables)" as nfqueue
participant "Queue Processor\n(lunfqueue)" as lunfqueue
participant "Cache Server\n(resolvcache)" as resolvcache

nfqueue -> lunfqueue: packet{192.168.1.1->1.2.3.4}
lunfqueue -> resolvcache: check(192.168.1.1,1.2.3.4)
resolvcache --> lunfqueue: {resolved: true, timestamp: xxxxx}
lunfqueue --> nfqueue: verdict{accept}

nfqueue -> lunfqueue: packet{192.168.1.1->66.66.66.66}
lunfqueue -> resolvcache: check(192.168.1.1,66.66.66.66)
resolvcache --> lunfqueue: {resolved: false, cachetime: xxxxx}
lunfqueue --> nfqueue: verdict{drop}
----

ifdef::env-site,env-github[]
A continuaci칩n: xref:design.adoc[Dise침o del sistema]
endif::env-site,env-github[]
